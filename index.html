<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uniswap — Demo Clone (Wallet Connect)</title>
  <meta name="description" content="Front-end lookalike of the Uniswap swap UI with basic wallet connect and ERC‑20 balances. No swaps." />
  <style>
    :root{
      --bg:#0b0b0f;           
      --surface:#111216;      
      --border:#24262c;       
      --ink:#e9ecf1;          
      --muted:#9aa0ab;        
      --accent:#ff2db2;       
      --pill:#17181f;         
      --shadow:0 8px 28px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(900px 700px at 70% -10%, rgba(255,45,178,.16), transparent 55%),
                  radial-gradient(700px 600px at -10% 10%, rgba(168,85,247,.12), transparent 50%),
                  var(--bg);
      color:var(--ink);
    }
    .wrap{max-width:1200px;margin:0 auto;padding:20px}
    header{display:grid;grid-template-columns:220px 1fr 260px;align-items:center;gap:12px;margin-bottom:24px}
    .brand{display:flex;align-items:center;gap:10px}
    .uni{width:26px;height:26px;border-radius:7px;display:grid;place-items:center;background:radial-gradient(circle at 30% 30%, #ff8ad5, #ff2db2);box-shadow:var(--shadow)}
    .uni svg{width:18px;height:18px;fill:white}
    nav{display:flex;gap:18px;margin-left:6px}
    .search{max-width:560px;margin:0 auto;width:100%;display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:999px;background:#0f1016;border:1px solid #1d2026;color:#cfd3da}
    .search input{flex:1;background:transparent;border:0;outline:0;color:#cfd3da;font-size:14px}
    .top-right{display:flex;justify-content:flex-end;gap:10px;align-items:center;position:relative}
    .dots{width:40px;height:40px;border-radius:999px;border:1px solid #23262f;background:#12131a;display:grid;place-items:center;cursor:pointer}

    .connect{padding:10px 16px;border-radius:999px;border:0;cursor:pointer;color:white;font-weight:600;background:linear-gradient(180deg, #ff2db2, #ff46c0)}

    /* Account pill */
    .account-btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid #2a2d36;background:#141720;border-radius:999px;color:#e7ecfb;cursor:pointer}
    .account-avatar{width:20px;height:20px;border-radius:6px;display:inline-block}
    .account-text{font-weight:600;font-size:14px}

    .account-menu{position:absolute;right:0;top:52px;width:220px;background:#12141b;border:1px solid #232634;border-radius:12px;box-shadow:var(--shadow);display:none;z-index:30}
    .account-menu.show{display:block}
    .account-menu .row{display:flex;align-items:center;gap:10px;padding:10px 12px;color:#cbd2df}
    .account-menu .row + .row{border-top:1px solid #232634}
    .account-menu button{width:100%;text-align:left;background:transparent;border:0;color:#e7ecfb;padding:8px 12px;cursor:pointer}

    .main{display:grid;place-items:center;margin-top:34px}
    .card{width:100%;max-width:580px;background:var(--surface);border:1px solid var(--border);border-radius:22px;box-shadow:var(--shadow)}
    .card-inner{padding:12px}
    .pill{padding:6px 12px;border-radius:999px;background:#17181f;border:1px solid #22242b;color:#d9dde6;font-size:13px}
    .gear{width:36px;height:36px;border-radius:10px;border:1px solid #22242b;background:#14161d;display:grid;place-items:center}
    .swap-box{margin-top:4px;border:1px solid var(--border);background:#0e0f14;border-radius:18px;overflow:hidden}
    .line{display:flex;align-items:center;gap:10px;padding:16px}
    .label{font-size:12px;color:#a3a8b4;margin-bottom:6px}
    .amt input{width:100%;background:transparent;border:0;outline:0;color:#fff;font-size:46px;line-height:1}
    .usd{font-size:12px;color:#7f8696;margin-top:6px}
    .token-btn{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:14px;background:#171820;border:1px solid #272a33}
    .switch{position:absolute;left:50%;transform:translate(-50%,-50%);top:0;width:44px;height:44px;border-radius:14px;border:1px solid #2a2d36;background:#13151c;display:grid;place-items:center}
    .cta{padding:14px}
    .swap-btn{width:100%;padding:16px;border-radius:14px;border:0;font-weight:700;color:white;opacity:.95;background:linear-gradient(180deg, rgba(255,45,178,.9), rgba(255,45,178,.75))}
    .meta{display:flex;justify-content:space-between;padding:10px 4px 2px;color:#98a0ad;font-size:12px}

    .note{display:none;margin:0 auto 12px;max-width:580px;color:#cbd2df;background:#12151e;border:1px solid #232634;border-radius:12px;padding:10px 12px;font-size:14px}
    .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#161821;border:1px solid #2a2d36;color:#e6ebff;padding:10px 14px;border-radius:10px;display:none;z-index:50}
    .toast.show{display:block}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="uni" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 3c1.8 0 3.2 1.2 4.1 2.6.9 1.3 2.8.9 3.4-.6.1-.3.5-.4.7-.1.5.6.8 1.3.8 2.1 0 2.2-2 3.2-3.7 3.4-.5 2.6-2.6 4.6-5.3 5-1.6.3-3.2-.1-4.4-1.1-.2 2.2 1.2 4.4 3.4 5.1.3.1.4.5.1.7-2.6 1.9-6.3.2-7-3-.9-4 2.3-7.8 6.4-7.8h.3C11 7.1 9.8 6.5 9 5.6 8 4.6 9.5 3 10.9 3h1.1Z"/></svg></div>
        <strong>Uniswap</strong>
        <nav><a>Trade</a><a>Explore</a><a>Pool</a></nav>
      </div>
      <div class="search"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="#93a0c8" d="M15.5 14h-.8l-.3-.3a6.5 6.5 0 1 0-.7.7l.3.3v.8l5 5 1.5-1.5-5-5zM10 15a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/></svg><input placeholder="Search tokens and pools" /></div>
      <div class="top-right">
        <div class="dots"><svg viewBox="0 0 24 24"><path d="M12 6a2 2 0 110-4 2 2 0 010 4zm0 8a2 2 0 110-4 2 2 0 010 4zm0 8a2 2 0 110-4 2 2 0 010 4z"/></svg></div>
        <button class="connect" id="connectBtn" onclick="connectWallet()">Connect</button>
        <button class="account-btn" id="accountBtn" style="display:none">
          <span class="account-avatar" id="acctAvatar" aria-hidden="true"></span>
          <span class="account-text" id="acctText">0x0000…0000</span>
        </button>
        <div class="account-menu" id="accountMenu">
          <div class="row" style="justify-content:space-between"><span id="menuAddr">—</span><button onclick="copyAddr()">Copy</button></div>
          <div class="row"><button onclick="disconnectWallet()">Disconnect</button></div>
        </div>
      </div>
    </header>

    <div id="walletNotice" class="note">Connected to <span id="walletNetwork">—</span> • <span id="walletAddr">—</span></div>
    <div id="walletHelp" class="note" style="display:none">No wallet detected. If MetaMask is installed, enable <b>Allow access to file URLs</b> in the extension or serve this file from <code>http://localhost</code>.</div>

    <section class="main">
      <div class="card"><div class="card-inner">
        <div style="display:flex;justify-content:space-between;align-items:center;padding:6px 6px 10px">
          <div style="display:flex;gap:6px"><div class="pill">Swap</div><div class="pill">Limit</div><div class="pill">Buy</div><div class="pill">Sell</div></div>
          <div class="gear"><svg viewBox="0 0 24 24"><path d="M19.4 13a7.8 7.8 0 0 0 0-2l2-.9-1.6-2.8-2 .9a7.7 7.7 0 0 0-1.7-1l.1-2.1h-3.2l.1 2.1c-.6.2-1.2.5-1.8.9l-1.9-1.1-1.6 2.8 1.9 1.1c-.1.7-.1 1.3 0 2l-1.9 1.1 1.6 2.8 1.9-1.1c.6.4 1.2.7 1.8.9l-.1 2.1h3.2l-.1-2.1c.6-.3 1.1-.6 1.7-1l2 .9 1.6-2.8-2-.9ZM12 14.5A2.5 2.5 0 1 1 12 9a2.5 2.5 0 0 1 0 5.5Z"/></svg></div>
        </div>

        <div class="swap-box">
          <div class="line" style="border-bottom:1px solid var(--border)">
            <div style="flex:1">
              <div class="label">Sell</div>
              <div class="amt"><input id="fromAmt" inputmode="decimal" placeholder="0" /></div>
              <div class="usd" id="fromUsd">$0</div>
            </div>
            <button class="token-btn" id="fromTokenBtn"><div>Ξ</div><div id="fromSym" style="font-weight:600">ETH</div></button>
          </div>
          <div style="position:relative;height:0"><div class="switch" id="switchBtn"><svg viewBox="0 0 24 24"><path d="M7 7h11v2H7v3L3 8l4-4v3zm10 10H6v-2h11v-3l4 4-4 4v-3z"/></svg></div></div>
          <div class="line">
            <div style="flex:1">
              <div class="label">Buy</div>
              <div class="amt"><input id="toAmt" inputmode="decimal" placeholder="0" /></div>
              <div class="usd" id="toUsd">0</div>
            </div>
            <button class="token-btn" id="toTokenBtn"><div>$</div><div id="toSym" style="font-weight:600">USDC</div></button>
          </div>
        </div>

        <div class="meta"><div>Rate</div><div id="rateText">1 ETH ≈ 3500.00 USDC</div></div>
        <div class="cta"><button class="swap-btn" id="swapBtn" onclick="toast('Demo only — swaps disabled.')">Connect wallet</button></div>

        <div id="balances" style="display:none;margin-top:8px;border-top:1px solid var(--border);padding:12px 6px 6px;color:#cfd5e3">
          <div style="font-size:12px;color:#99a1af;margin-bottom:6px">Balances</div>
          <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px">
            <div style="background:#12141c;border:1px solid #232634;border-radius:12px;padding:10px"><b>ETH</b><div id="balETH" class="usd">0</div></div>
            <div style="background:#12141c;border:1px solid #232634;border-radius:12px;padding:10px"><b>DAI</b><div id="balDAI" class="usd">0</div></div>
            <div style="background:#12141c;border:1px solid #232634;border-radius:12px;padding:10px"><b>USDC</b><div id="balUSDC" class="usd">0</div></div>
            <div style="background:#12141c;border:1px solid #232634;border-radius:12px;padding:10px"><b>USDT</b><div id="balUSDT" class="usd">0</div></div>
          </div>
        </div>
      </div></div>
    </section>
  </div>

  <div class="toast" id="toast">Note</div>

  <script>
    // ===== Utility =====
    function qs(s){ return document.querySelector(s); }
    function fmt(x, d=2){ if(!isFinite(x)) return '0'; const abs=Math.abs(x); if(abs>1) return x.toLocaleString(undefined,{maximumFractionDigits:d}); return x.toLocaleString(undefined,{maximumFractionDigits:6}); }
    function toast(msg){ const t=qs('#toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 2200); }
    function shorten(a){ return a.slice(0,6)+'…'+a.slice(-4); }

    // Simple identicon (5x5) SVG based on address hash
    function identiconSVG(addr){
      function hash(s){ let h=2166136261>>>0; for(let i=0;i<s.length;i++){ h^=s.charCodeAt(i); h=(h>>>0)*16777619>>>0; } return h>>>0; }
      const h = hash(addr.toLowerCase());
      const hue = h % 360; const c = `hsl(${hue} 70% 55%)`;
      let bits = h;
      let cells='';
      for(let y=0;y<5;y++){
        let row = [];
        for(let x=0;x<3;x++){ row.push((bits>>>(y*3+x)) & 1); }
        const full = row.concat([row[1], row[0]]);
        for(let x=0;x<5;x++){ if(full[x]) cells += `<rect x="${x}" y="${y}" width="1" height="1"/>`; }
      }
      return `<svg viewBox="0 0 5 5" width="20" height="20" style="border-radius:6px; background:#0f1117"><g fill="${c}">${cells}</g></svg>`;
    }

    // ===== Demo pricing =====
    const TOKENS = [ {sym:'ETH', priceUSD:3500}, {sym:'USDC', priceUSD:1}, {sym:'DAI', priceUSD:1}, {sym:'USDT', priceUSD:1} ];
    let from = TOKENS[0], to = TOKENS[1];
    function updateHeaders(){ const rate = from.priceUSD / to.priceUSD; qs('#rateText').textContent = `1 ${from.sym} ≈ ${fmt(rate, 4)} ${to.sym}`; compute(); }
    function compute(){ const a=parseFloat(qs('#fromAmt').value); const px=from.priceUSD/to.priceUSD; if(!isFinite(a)){ qs('#toAmt').value=''; qs('#fromUsd').textContent='$0'; qs('#toUsd').textContent='0'; return;} const out=a*px; qs('#toAmt').value=out?fmt(out):''; qs('#fromUsd').textContent='$'+fmt(a*from.priceUSD); qs('#toUsd').textContent=fmt(out); }
    qs('#fromAmt').addEventListener('input', compute);
    qs('#switchBtn').addEventListener('click', ()=>{ const tmp=from; from=to; to=tmp; qs('#fromSym').textContent=from.sym; qs('#toSym').textContent=to.sym; updateHeaders(); });

    // ===== Wallet connect =====
    const ERC20S = {
      DAI: {addr:'0x6B175474E89094C44Da98b954EedeAC495271d0F', decimals:18},
      USDC:{addr:'0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eb48', decimals:6},
      USDT:{addr:'0xdAC17F958D2ee523a2206206994597C13D831ec7', decimals:6}
    };
    function formatUnitsBI(hexOrBI,dec){ const s=BigInt(hexOrBI).toString(); const pad=Number(dec); const int=s.length>pad?s.slice(0,-pad):'0'; const frac=s.length>pad?s.slice(-pad):s.padStart(pad,'0'); const out=int+(pad?'.':'')+frac.replace(/0+$/,''); return out.endsWith('.')?out.slice(0,-1):out; }

    let currentAddress = null;

    async function connectWallet(){
      try{
        if(typeof window.ethereum === 'undefined'){ qs('#walletHelp').style.display='block'; toast('Wallet not detected. See help above.'); return; }
        const accounts = await window.ethereum.request({ method:'eth_requestAccounts' });
        if(!accounts || !accounts[0]){ toast('No account selected.'); return; }
        const addr = accounts[0];
        currentAddress = addr;
        const chainId = await window.ethereum.request({ method:'eth_chainId' });
        qs('#walletNotice').style.display='block';
        qs('#walletAddr').textContent = shorten(addr);
        qs('#walletNetwork').textContent = (chainId === '0x1') ? 'Ethereum Mainnet' : `Chain ${parseInt(chainId,16)}`;
        qs('#balances').style.display='block';
        await loadBalances(addr);
        // swap connect button for account pill
        const pill = qs('#accountBtn');
        pill.style.display='inline-flex';
        pill.innerHTML = identiconSVG(addr) + `<span class="account-text">${shorten(addr)}</span>`;
        qs('#connectBtn').style.display='none';
        qs('#menuAddr').textContent = addr;
        // listeners
        window.ethereum.removeListener && window.ethereum.removeListener('accountsChanged', onAccountsChanged);
        window.ethereum.on && window.ethereum.on('accountsChanged', onAccountsChanged);
        window.ethereum.removeListener && window.ethereum.removeListener('chainChanged', onChainChanged);
        window.ethereum.on && window.ethereum.on('chainChanged', onChainChanged);
      }catch(e){ console.error(e); toast('Wallet connection failed.'); }
    }

    async function onAccountsChanged(accts){ if(accts && accts[0]){ currentAddress = accts[0]; await loadBalances(accts[0]); qs('#walletAddr').textContent = shorten(accts[0]); const pill = qs('#accountBtn'); pill.innerHTML = identiconSVG(accts[0]) + `<span class="account-text">${shorten(accts[0])}</span>`; qs('#menuAddr').textContent = accts[0]; } }
    function onChainChanged(){ location.reload(); }

    // Simple dropdown for account pill
    qs('#accountBtn').addEventListener('click', ()=>{ const m=qs('#accountMenu'); m.classList.toggle('show'); });
    document.addEventListener('click', (e)=>{ const m=qs('#accountMenu'); const btn=qs('#accountBtn'); if(!m.contains(e.target) && e.target!==btn && !btn.contains(e.target)) m.classList.remove('show'); });

    async function copyAddr(){ if(!currentAddress) return; try{ await navigator.clipboard.writeText(currentAddress); toast('Address copied'); }catch{ toast('Could not copy.'); } }

    function disconnectWallet(){
      // There is no standard provider method to programmatically disconnect injected wallets.
      // We simply reset UI state so you can test reconnection flows.
      currentAddress = null;
      qs('#walletNotice').style.display='none';
      qs('#balances').style.display='none';
      qs('#accountMenu').classList.remove('show');
      qs('#accountBtn').style.display='none';
      qs('#connectBtn').style.display='inline-block';
      toast('Disconnected (UI reset).');
    }

    async function loadBalances(addr){
      try{
        const wei = await window.ethereum.request({ method:'eth_getBalance', params:[addr, 'latest'] });
        const eth = Number(formatUnitsBI(wei,18)); qs('#balETH').textContent = eth.toLocaleString(undefined,{maximumFractionDigits:6});
        for(const [sym,info] of Object.entries(ERC20S)){
          const data = '0x70a08231' + addr.replace(/^0x/,'').padStart(64,'0');
          const res = await window.ethereum.request({ method:'eth_call', params:[{to:info.addr, data}, 'latest'] });
          const val = Number(formatUnitsBI(res, info.decimals));
          qs('#bal'+sym).textContent = val.toLocaleString(undefined,{maximumFractionDigits:6});
        }
      }catch(e){ console.error(e); toast('Failed to load balances.'); }
    }

    // ===== Init =====
    updateHeaders();
  </script>
</body>
</html>

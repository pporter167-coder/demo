<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uniswap — Demo Clone (Network Switch)</title>
  <style>
    :root{--bg:#0b0b0f;--surface:#111216;--border:#24262c;--ink:#e9ecf1;--muted:#9aa0ab;--accent:#ff2db2;--shadow:0 8px 28px rgba(0,0,0,.45)}
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:radial-gradient(900px 700px at 70% -10%, rgba(255,45,178,.16), transparent 55%),radial-gradient(700px 600px at -10% 10%, rgba(168,85,247,.12), transparent 50%),var(--bg);color:var(--ink)}
    .wrap{max-width:1200px;margin:0 auto;padding:20px}
    header{display:grid;grid-template-columns:220px 1fr 360px;align-items:center;gap:12px;margin-bottom:24px}
    .brand{display:flex;align-items:center;gap:10px}
    .uni{width:26px;height:26px;border-radius:7px;display:grid;place-items:center;background:radial-gradient(circle at 30% 30%, #ff8ad5, #ff2db2)}
    .uni svg{width:18px;height:18px;fill:#fff}
    nav{display:flex;gap:18px;margin-left:6px;color:#cdd3df}
    .search{max-width:560px;margin:0 auto;width:100%;display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:999px;background:#0f1016;border:1px solid #1d2026;color:#cfd3da}
    .search input{flex:1;background:transparent;border:0;outline:0;color:#cfd3da;font-size:14px}
    .top-right{display:flex;justify-content:flex-end;gap:10px;align-items:center;position:relative}
    .dots{width:40px;height:40px;border-radius:999px;border:1px solid #23262f;background:#12131a;display:grid;place-items:center}
    .connect{padding:10px 16px;border-radius:999px;border:0;cursor:pointer;color:#fff;font-weight:600;background:linear-gradient(180deg,#ff2db2,#ff46c0)}
    .account-btn{display:none;align-items:center;gap:8px;padding:8px 12px;border:1px solid #2a2d36;background:#141720;border-radius:999px;color:#e7ecfb}
    .account-text{font-weight:600;font-size:14px}
    .net-select{appearance:none;background:#141720;border:1px solid #2a2d36;color:#e7ecfb;border-radius:10px;padding:8px 10px;font-size:13px;cursor:pointer}
    .net-select:focus{outline:none;box-shadow:0 0 0 2px rgba(255,45,178,.3)}

    .main{display:grid;place-items:center;margin-top:34px}
    .card{width:100%;max-width:580px;background:var(--surface);border:1px solid var(--border);border-radius:22px;box-shadow:var(--shadow)}
    .card-inner{padding:12px}
    .pill{padding:6px 12px;border-radius:999px;background:#17181f;border:1px solid #22242b;color:#d9dde6;font-size:13px}
    .gear{width:36px;height:36px;border-radius:10px;border:1px solid #22242b;background:#14161d;display:grid;place-items:center}
    .swap-box{margin-top:4px;border:1px solid var(--border);background:#0e0f14;border-radius:18px;overflow:hidden}
    .line{display:flex;align-items:center;gap:10px;padding:16px}
    .label{font-size:12px;color:#a3a8b4;margin-bottom:6px}
    .amt input{width:100%;background:transparent;border:0;outline:0;color:#fff;font-size:46px;line-height:1}
    .usd{font-size:12px;color:#7f8696;margin-top:6px}
    .token-btn{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:14px;background:#171820;border:1px solid #272a33}
    .switch{position:absolute;left:50%;transform:translate(-50%,-50%);top:0;width:44px;height:44px;border-radius:14px;border:1px solid #2a2d36;background:#13151c;display:grid;place-items:center}
    .cta{padding:14px}
    .swap-btn{width:100%;padding:16px;border-radius:14px;border:0;font-weight:700;color:#fff;opacity:.95;background:linear-gradient(180deg, rgba(255,45,178,.9), rgba(255,45,178,.75))}
    .meta{display:flex;justify-content:space-between;padding:10px 4px 2px;color:#98a0ad;font-size:12px}

    .note{display:none;margin:0 auto 12px;max-width:580px;color:#cbd2df;background:#12151e;border:1px solid #232634;border-radius:12px;padding:10px 12px;font-size:14px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="uni">
          <svg viewBox="0 0 24 24"><path d="M12 3c1.8 0 3.2 1.2 4.1 2.6.9 1.3 2.8.9 3.4-.6.1-.3.5-.4.7-.1.5.6.8 1.3.8 2.1 0 2.2-2 3.2-3.7 3.4-.5 2.6-2.6 4.6-5.3 5-1.6.3-3.2-.1-4.4-1.1-.2 2.2 1.2 4.4 3.4 5.1.3.1.4.5.1.7-2.6 1.9-6.3.2-7-3-.9-4 2.3-7.8 6.4-7.8h.3C11 7.1 9.8 6.5 9 5.6 8 4.6 9.5 3 10.9 3h1.1Z" fill="#fff"/></svg>
        </div>
        <strong>Uniswap</strong>
        <nav><span>Trade</span><span>Explore</span><span>Pool</span></nav>
      </div>

      <div class="search">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="#93a0c8" d="M15.5 14h-.8l-.3-.3a6.5 6.5 0 1 0-.7.7l.3.3v.8l5 5 1.5-1.5-5-5zM10 15a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/></svg>
        <input placeholder="Search tokens and pools" />
      </div>

      <div class="top-right">
        <div class="dots"><svg viewBox="0 0 24 24"><circle cx="12" cy="4" r="2" fill="#cfd3da"/><circle cx="12" cy="12" r="2" fill="#cfd3da"/><circle cx="12" cy="20" r="2" fill="#cfd3da"/></svg></div>
        <!-- Network dropdown -->
        <select id="networkSelect" class="net-select" title="Select network">
          <option value="0xaa36a7" selected>Sepolia</option>
          <option value="0x1">Mainnet</option>
        </select>
        <!-- Wallet buttons -->
        <button class="connect" id="connectBtn" onclick="connectWallet()">Connect</button>
        <button class="account-btn" id="accountBtn"><span class="account-text">0x0000…0000</span></button>
      </div>
    </header>

    <div id="walletNotice" class="note">Connected to <span id="walletNetwork">—</span> • <span id="walletAddr">—</span></div>

    <section class="main">
      <div class="card">
        <div class="card-inner">
          <div style="display:flex;justify-content:space-between;align-items:center;padding:6px 6px 10px">
            <div style="display:flex;gap:6px"><div class="pill">Swap</div><div class="pill">Limit</div><div class="pill">Buy</div><div class="pill">Sell</div></div>
            <div class="gear"><svg viewBox="0 0 24 24"><path d="M19.4 13a7.8 7.8 0 0 0 0-2l2-.9-1.6-2.8-2 .9a7.7 7.7 0 0 0-1.7-1l.1-2.1h-3.2l.1 2.1c-.6.2-1.2.5-1.8.9l-1.9-1.1-1.6 2.8 1.9 1.1c-.1.7-.1 1.3 0 2l-1.9 1.1 1.6 2.8 1.9-1.1c.6.4 1.2.7 1.8.9l-.1 2.1h3.2l-.1-2.1c.6-.3 1.1-.6 1.7-1l2 .9 1.6-2.8-2-.9ZM12 14.5A2.5 2.5 0 1 1 12 9a2.5 2.5 0 0 1 0 5.5Z" fill="#cfd3da"/></svg></div>
          </div>

          <div class="swap-box">
            <div class="line" style="border-bottom:1px solid var(--border)">
              <div style="flex:1">
                <div class="label">Sell</div>
                <div class="amt"><input inputmode="decimal" placeholder="0" /></div>
                <div class="usd">$0</div>
              </div>
              <button class="token-btn"><div>Ξ</div><div style="font-weight:600">ETH</div></button>
            </div>

            <div style="position:relative;height:0">
              <div class="switch"><svg viewBox="0 0 24 24"><path d="M7 7h11v2H7v3L3 8l4-4v3zm10 10H6v-2h11v-3l4 4-4 4v-3z" fill="#cfd3da"/></svg></div>
            </div>

            <div class="line">
              <div style="flex:1">
                <div class="label">Buy</div>
                <div class="amt"><input inputmode="decimal" placeholder="0" /></div>
                <div class="usd">0</div>
              </div>
              <button class="token-btn"><div>$</div><div style="font-weight:600">USDC</div></button>
            </div>
          </div>

          <div class="meta"><div>Rate</div><div id="rateText">1 ETH ≈ 3500.00 USDC</div></div>
          <div class="cta"><button class="swap-btn" onclick="connectWallet()">Connect wallet</button></div>
        </div>
      </div>
    </section>
  </div>

  <!-- Minimal, safe script with forced network switch -->
  <script>
  (() => {
    // ---------- helpers ----------
    const qs = s => document.querySelector(s);
    const shorten = a => a ? a.slice(0,6) + '…' + a.slice(-4) : '';

    // Your DAI addresses (mainnet + your Sepolia deployment)
    const DAI_ADDRS = {
      '0x1':      '0x6B175474E89094C44Da98b954EedeAC495271d0F', // Mainnet
      '0xaa36a7': '0x21AfeE016BdcF5fa32308816f8612e016D2b65F7', // Sepolia (yours)
    };
    let DAI = DAI_ADDRS['0xaa36a7']; // default to Sepolia
    let currentAddress = null;

    function getSelectedChainId() {
      const el = qs('#networkSelect');
      return el && el.value ? el.value : '0xaa36a7';
    }
    function setChainConfig(chainIdHex) {
      DAI = DAI_ADDRS[chainIdHex] || DAI_ADDRS['0x1'];
    }
    function labelForChain(id){
      if(id==='0x1') return 'Ethereum Mainnet';
      if(id==='0xaa36a7') return 'Ethereum Sepolia';
      try { return 'Chain ' + parseInt(id,16); } catch { return 'Unknown'; }
    }

    async function ensureChain(target='0xaa36a7') {
      if (!window.ethereum) { alert('Install MetaMask'); return false; }
      let cur;
      try { cur = await ethereum.request({ method:'eth_chainId' }); } catch { cur = null; }
      if (cur === target) return true;

      try {
        await ethereum.request({ method:'wallet_switchEthereumChain', params:[{ chainId: target }] });
        return true;
      } catch (e) {
        // If chain not added yet, add Sepolia
        if (e && e.code === 4902 && target === '0xaa36a7') {
          try {
            await ethereum.request({
              method:'wallet_addEthereumChain',
              params:[{
                chainId:'0xaa36a7',
                chainName:'Sepolia',
                nativeCurrency:{ name:'Sepolia ETH', symbol:'SEP', decimals:18 },
                rpcUrls:['https://rpc.sepolia.org'],
                blockExplorerUrls:['https://sepolia.etherscan.io']
              }]
            });
            return true;
          } catch (e2) {
            console.warn('add chain failed', e2);
            return false;
          }
        }
        console.warn('switch chain failed', e);
        return false;
      }
    }

    // ---------- globals required by the page ----------
    window.updateHeaders = function () {
      const el = qs('#rateText');
      if (el) el.textContent = '1 ETH ≈ 3500.00 USDC';
    };

    window.connectWallet = async function () {
      const target = getSelectedChainId();
      const ok = await ensureChain(target);
      if (!ok) { console.warn('User declined network switch'); return; }

      setChainConfig(target);
      const [addr] = await ethereum.request({ method:'eth_requestAccounts' });
      currentAddress = addr;

      // UI updates
      const connectBtn = qs('#connectBtn');
      const accountBtn = qs('#accountBtn');
      if (connectBtn) connectBtn.style.display = 'none';
      if (accountBtn) {
        accountBtn.style.display = 'inline-flex';
        accountBtn.innerHTML = `<span class="account-text">${shorten(addr)}</span>`;
      }
      const notice = qs('#walletNotice');
      if (notice) notice.style.display = 'block';
      const netEl = qs('#walletNetwork');
      const addrEl = qs('#walletAddr');
      if (netEl) netEl.textContent = labelForChain(target);
      if (addrEl) addrEl.textContent = shorten(addr);
    };

    window.disconnectWallet = function () {
      currentAddress = null;
      const connectBtn = qs('#connectBtn');
      const accountBtn = qs('#accountBtn');
      const notice = qs('#walletNotice');
      if (accountBtn) accountBtn.style.display = 'none';
      if (connectBtn) connectBtn.style.display = 'inline-block';
      if (notice) notice.style.display = 'none';
    };

    // ---------- boot ----------
    document.addEventListener('DOMContentLoaded', async () => {
      // keep dropdown & labels in sync with wallet
      let cur = null;
      try { cur = await window.ethereum?.request({ method:'eth_chainId' }); } catch {}
      const selected = cur || getSelectedChainId();
      setChainConfig(selected);
      const netEl = qs('#walletNetwork');
      if (netEl) netEl.textContent = labelForChain(selected);
      const sel = qs('#networkSelect');
      if (sel) sel.value = selected;

      if (sel) {
        sel.addEventListener('change', async (e) => {
          const id = e.target.value;
          const ok = await ensureChain(id);
          if (ok) {
            setChainConfig(id);
            const netEl2 = qs('#walletNetwork');
            if (netEl2) netEl2.textContent = labelForChain(id);
          } else {
            try { sel.value = await ethereum.request({ method:'eth_chainId' }); } catch {}
          }
        });
      }

      // avoid “updateHeaders is not defined”
      window.updateHeaders();
    });
  })();
  </script>
</body>
</html>
